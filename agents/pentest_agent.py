from pydantic import BaseModel
from crewai import Agent
from tools.nmap_tool import NmapScanTool
from tools.zap_tool import OWASPZAPTool
from tools.api_enum_tool import APIEnumeratorTool 


class TargetInput(BaseModel):
    target: str

nmap_tool = NmapScanTool()

nmap_recon_agent = Agent(
    role="Network Reconnaissance Agent",
    goal="Scan the target for open ports using Nmap and report findings",
    backstory="You are a skilled cybersecurity analyst with expertise in network scanning and reconnaissance. Your mission is to assess exposed ports and services.",
    verbose=True,
    allow_delegation=False,
    tools=[nmap_tool],
    args_schema=TargetInput
)

zap_tool = OWASPZAPTool()
zap_recon_agent = Agent(
    role="Web Application Security Agent",
    goal="Perform a security scan on the target web application using OWASP ZAP",
    backstory="You are an expert in web application security, tasked with identifying vulnerabilities in web applications.",
    verbose=True,   
    allow_delegation=False,
    tools=[zap_tool],
    args_schema=TargetInput
)

api_enum_agent = Agent(
    role="API Enumeration Agent",
    goal="Identify API endpoints such as REST and GraphQL on the target system.",
    backstory="An expert in identifying exposed API surfaces and misconfigurations.",
    verbose=True,
    tools=[APIEnumeratorTool()]
)
